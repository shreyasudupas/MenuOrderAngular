<!-- {{vendorId}} -->
<p-toast></p-toast>

<p-card [header]="header">
    <p-tabView [scrollable]="true">
        <p-tabPanel header="Vendor Details">
            <p-scrollTop></p-scrollTop>
            <p-scrollPanel [style]="{width: '100%', height: '600px'}" styleClass="custombar">
                <form [formGroup]="vendorDetailForm" (ngSubmit)="onSubmitVendorDetails(vendorDetailForm)">
                    <div class="p-fluid formgrid">
                        <div class="field col-12">
                            <div *ngIf="vendorImageUrl !== undefined">
                                
                                <img [src]="vendorImageUrl" 
                                     alt="default Vendor Image"
                                     width="140px"
                                     height="120px"
                                     />
                            </div>
                        </div>
                    </div>
                    <div class="p-fluid formgrid  grid">
                        <div class="field col-12">
                            <span class="p-float-label field">
                                <input id="vendorName" type="text" formControlName="vendorName" pInputText
                                    class="w-full">
                                <label for="vendorName">Vendor Name</label>
                            </span>
                            <div *ngIf="formControlValidation('vendorName')" class="ng-invalid ng-dirty">
                                <div class="col-12 error">
                                    Please provide a name.
                                </div>
                            </div>
                        </div>
                        <div class="field col-12">
                            <span class="p-float-label field">
                                <input id="vendorDescription" type="text" formControlName="vendorDescription" pInputText
                                    class="w-full">
                                <label for="vendorDescription">Vendor Description</label>
                            </span>
                            <div *ngIf="formControlValidation('vendorDescription')" class="ng-invalid ng-dirty">
                                Please provide a Description.
                            </div>
                        </div>

                        <div class="field col-12">
                            <span class="field p-float-label p-2">
                                <p-multiSelect [options]="cuisineDropDownList" formControlName="cuisineType"
                                    defaultLabel="Select a Cuisine Type" optionLabel="cuisineName"
                                    optionValue="cuisineName" display="chip" inputId="cuisineType">
                                </p-multiSelect>
                                <label for="state">Select a Cuisine Type</label>
                            </span>
                        </div>

                        <div class="field col-6">
                            <label for="openTimings">Open Timings</label>
                            <p-calendar formControlName="openTime" [timeOnly]="true" [hourFormat]="'12'"
                                inputId="openTimings"></p-calendar>
                        </div>

                        <div class="field col-6">
                            <label for="closeTimings">Close Timings</label>
                            <p-calendar formControlName="closeTime" [timeOnly]="true" [hourFormat]="'12'"
                                inputId="closeTimings"></p-calendar>
                        </div>

                        <div class="field-radiobutton col-6 p-2">
                            <p-radioButton name="active" [value]="true" formControlName="active"
                                inputId="active"></p-radioButton>
                            <label for="active">Active</label>
                        </div>

                        <div class="field-radiobutton col-6">
                            <p-radioButton name="active" [value]="false" formControlName="active"
                                inputId="inActive"></p-radioButton>
                            <label for="inActive">InActive</label>
                        </div>

                        <div class="field col-12">
                            <div *ngIf="latitude !== undefined && longitude !== undefined">
                                <vendor-map [latitude] = "latitude"
                                            [longitude] = "longitude"
                                            [userMarkerRequired]="false"
                                            [customAddressMarkerRequired]="true"
                                            (customAddressLatLongValues)="getLatLongFromUserSelection($event)"></vendor-map>
                            </div>
                        </div>

                        <div class="field col-12 p-2">
                            <span class="p-float-label field">
                                <input id="latitude" type="text" formControlName="latitude" pInputText>
                                <label for="latitude">Enter Latitude Coordinate</label>
                            </span>

                            <div *ngIf="vendorDetailForm.get('latitude').errors?.['inCorrectCoordinates']">
                                <div class="col-12 error">
                                    *Coordinates is not valid format.
                                </div>
                            </div>
                        </div>

                        <div class="field col-12">
                            <span class="p-float-label field">
                                <input id="longitude" type="text" formControlName="longitude" pInputText>
                                <label for="longitude">Enter Longitude Coordinate</label>
                            </span>

                            <div *ngIf="vendorDetailForm.get('longitude').errors?.['inCorrectCoordinates']">
                                <div class="col-12 error">
                                    *Coordinates is not valid format.
                                </div>
                            </div>
                        </div>

                        <div class="field p-2">
                            <p-button label="Auto Generate Address" 
                                      pTooltip="Adjust the marker on the map based on your location and then click to generate the address" tooltipPosition="right"
                                      styleClass="p-button-raised" 
                                      (click)="getAutoGeneratedAddress()"></p-button>
                        </div>
                        <div class="field col-12 p-2">
                            <span class="p-float-label">
                                <p-dropdown [options]="stateDropDownValues" id="state" placeholder="Select State"
                                    optionLabel="label" optionValue="value" autoWidth="false" [style]="{'width':'100%'}"
                                    formControlName="state" (onChange)="getCities($event)" inputId="state"></p-dropdown>
                                <label for="state">Select State</label>
                                <div *ngIf="formControlValidation('state')" class="ng-invalid ng-dirty">
                                    Please choose a state.
                                </div>
                            </span>
                        </div>
                        <div class="field col-12 p-2">
                            <span class="p-float-label">
                                <p-dropdown [options]="cityDropDownListValues" id="city" placeholder="Select City"
                                    optionLabel="label" optionValue="value" autoWidth="false" [style]="{'width':'100%'}"
                                    inputId="city" formControlName="city" (onChange)="getAreas($event)"></p-dropdown>
                                <label for="city">Select City</label>
                                <div *ngIf="formControlValidation('city')" class="ng-invalid ng-dirty">
                                    Please choose a city.
                                </div>
                            </span>
                        </div>
                        <div class="field col-12 p-2">
                            <span class="p-float-label">
                                <p-dropdown [options]="areaDropDownListValues" id="area" placeholder="Select Area"
                                    optionLabel="label" optionValue="value" autoWidth="false" [style]="{'width':'100%'}"
                                    formControlName="area" inputId="area"></p-dropdown>
                                <label for="area">Select Area</label>
                                <div *ngIf="formControlValidation('area')" class="ng-invalid ng-dirty">
                                    Please choose a area.
                                </div>
                            </span>
                        </div>
                        <div class="field col-12 p-2">
                            <span class="p-float-label">
                                <input id="addressLine1" type="text" formControlName="addressLine1" pInputText
                                    class="w-full">
                                <label for="addressLine1">AddressLine 1</label>
                            </span>
                            <div *ngIf="formControlValidation('addressLine1')" class="ng-invalid ng-dirty">
                                Please enter addressLine 1.
                            </div>
                        </div>
                        <div class="field col-12">
                            <span class="p-float-label">
                                <input id="addressLine2" type="text" formControlName="addressLine2" pInputText
                                    class="w-full">
                                <label for="addressLine2">AddressLine 2</label>
                            </span>
                        </div>
                        
                        <div class="field col-12">
                            <!-- <p-gmap [options]="options" [style]="{'width':'100%','height':'320px'}" ></p-gmap> -->
                        </div>
                        <div class="field col-12">
                            <button pButton pRipple type="submit" label="Save"
                                class="p-button-rounded p-button-primary w-full"></button>
                        </div>
                    </div>
                </form>

                <div class="grid">
                    <div class="col-12">
                        <button pButton pRipple type="button" label="Back"
                            class="p-button-rounded p-button-secondary w-full" (click)="goBackToVendor()"></button>
                    </div>
                </div>

                <p-scrollTop target="parent" styleClass="custom-scrolltop" [threshold]="100"
                    icon="pi pi-arrow-up"></p-scrollTop>
            </p-scrollPanel>
        </p-tabPanel>
        <p-tabPanel header="Vendor Image Upload">
            <vendor-image-upload [vendorInfo]="vendorDetail" [vendorImage]="vendorImageUrl"></vendor-image-upload>
        </p-tabPanel>
        <p-tabPanel header="Add Users">
            <div *ngIf="vendorDetail.id !== undefined && vendorDetail.id != '' ">
                <vendor-user-list [vendorId]="vendorDetail.id"
                                  [vendorName]="vendorDetail.vendorName"></vendor-user-list>
            </div>
        </p-tabPanel>
        <p-tabPanel header="Category Details" [disabled]="categoryTab">
            <category-list [categories]="vendorDetail.categories" [vendorId]="vendorId"></category-list>
        </p-tabPanel>
        <p-tabPanel header="Menu Details" [disabled]="menuDetailTab">
            <vendor-menu-list [vendorId]="vendorId"></vendor-menu-list>
        </p-tabPanel>
    </p-tabView>

</p-card>